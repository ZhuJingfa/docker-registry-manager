language: go
sudo: required
services:
  - docker
go:
  - tip
install: true
# all deps are now vendored
#before_install:
#  - go get -v ./...
script:
  - ./.travis-test.sh
after_success:
  - bash <(curl -s https://codecov.io/bash)
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker build -t snagles/docker-registry-manager .;
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker push snagles/docker-registry-manager;
    fi
  - if [ "$TRAVIS_BRANCH" == "develop" ]; then
    docker build -t snagles/docker-registry-manager:develop .;
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker push snagles/docker-registry-manager:develop;
    fi
